version: 1
frontend:
  phases:
    preBuild:
      commands:
        # Initialize git submodules (for theme)
        - git submodule update --init --recursive
        # Install Hugo in user's home directory
        - wget https://github.com/gohugoio/hugo/releases/download/v0.100.0/hugo_extended_0.100.0_Linux-64bit.tar.gz
        - tar -xzf hugo_extended_0.100.0_Linux-64bit.tar.gz
        - mkdir -p ~/.local/bin
        - mv hugo ~/.local/bin/
        - export PATH="$PATH:$HOME/.local/bin"
        - hugo version
    build:
      commands:
        # Build with additional flags for better debugging and output
        - hugo --minify --baseURL $BASEURL --logLevel info --cleanDestinationDir --enableGitInfo --debug --printPathWarnings --gc
  artifacts:
    # Directory containing the generated site
    baseDirectory: public
    files:
      - '**/*'
  cache:
    paths:
      - hugo_extended_0.100.0_Linux-64bit.tar.gz
